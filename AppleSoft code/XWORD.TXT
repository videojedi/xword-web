 100  CLEAR  110  ONERR  GOTO 50000 120 D$ =  CHR$ (4) 130  PRINT D$;"PR#3" 140  DIM A$(16,8,25),B$(3000),C$(16),P$(16),W$(16),WW$(16),A(16),B(26),J(16,8),CC(16) 150  DATA          1,2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97 160  FOR I = 1 TO 26 170  READ B(I) 180 B(I) =  INT ( LOG (B(I)) * 1E8 + .5) 190  NEXT  200  PRINT D$;"CREATE/RAM5/DATA" 210  VTAB 12 220  GOSUB 45000 230  PRINT D$;"CLOSE" 240  HOME :M$ = "CROSSWORD SOLVING AID":MM$ = "BY C.A. SMALL ... APRIL 1988" 250 M =  LEN (M$):MM =  LEN (MM$) 260  VTAB 2: HTAB (79 - M) / 2: PRINT M$ 270  VTAB 4: HTAB (79 - MM) / 2: PRINT MM$ 280  VTAB 8: HTAB (20): PRINT "ENTER NEW WORDS IN DICTIONARY ........A" 290  VTAB 10: HTAB (20): PRINT "REMOVE DICTIONARY ENTRIES ............B" 300  VTAB 12: HTAB (20): PRINT "RECALL - PART WORD ...................C" 310  VTAB 14: HTAB (20): PRINT "SOLVE ANAGRAM ........................D" 330  VTAB 16: HTAB (20): PRINT "SORT AND QUIT ........................E" 350  VTAB 20: HTAB (26): PRINT "ENTER LETTER OF YOUR CHOICE" 360  GET R$ 370  IF  ASC (R$) > 64 AND  ASC (R$) < 71 THEN R$ =  CHR$ ( ASC (R$) + 32) 380  IF  ASC (R$) < 97 OR  ASC (R$) > 102 THEN 350 390 C =  ASC (R$) - 96 400  HOME  410  IF C >  < 1 GOTO 440 420  GOSUB 1000 430  GOTO 240 440  IF C >  < 2 GOTO 470 450  GOSUB 30420 460  GOTO 240 470  IF C >  < 3 GOTO 500 480  GOSUB 30000 490  GOTO 240 500  IF C >  < 4 GOTO 550 510  GOSUB 25000 550  IF C >  < 5 GOTO 240 552  HOME : VTAB 10: HTAB (20) 554  PRINT "DISPLAY WORDS ? ...... Y(es) or N(o) " 555  PRINT : HTAB (20) 556  GET W$: IF W$ = "N" OR W$ = "n" THEN MK = 1 560  GOSUB 20000 570  END  1000  INPUT "Enter WORD (3 to 16 characters)                     ";W$ 1010  IF W$ = "" GOTO 1000 1020 L =  LEN (W$) 1030  IF L < 3 OR L > 16 GOTO 1000 1040  GOSUB 2000 1050  IF P$ = "" GOTO 1000 1060  IF  ASC (P$) > 96 AND  ASC (P$) < 99 THEN LM = 1 1065  IF  ASC (P$) > 98 AND  ASC (P$) < 101 THEN LM = 2 1070  IF  ASC (P$) > 100 AND  ASC (P$) < 104 THEN LM = 3 1075  IF  ASC (P$) > 103 AND  ASC (P$) < 108 THEN LM = 4 1080  IF  ASC (P$) > 107 AND  ASC (P$) < 112 THEN LM = 5 1082  IF  ASC (P$) > 111 AND  ASC (P$) < 115 THEN LM = 6 1084  IF  ASC (P$) = 115 THEN LM = 7 1086  IF  ASC (P$) > 115 AND  ASC (P$) < 123 THEN LM = 8 1090  IF J(L,LM) = 0 GOTO 1130 1100  FOR I = 1 TO J(L,LM) 1110  IF P$ = A$(L,LM,I) THEN  GOTO 1170 1120  NEXT I 1130 J(0,0) = J(0,0) + 1 1140 J(L,LM) = J(L,LM) + 1 1150 A$(L,LM,J(L,LM)) = P$ 1160  IF J(L,LM) = 25 THEN  GOTO 1230 1170  PRINT "Do you wish to enter another word ? " 1180  PRINT "Y(es) or N(o) " 1190  GET W$ 1200  IF W$ = "Y" OR W$ = "y" GOTO 1000 1210  IF W$ = "N" OR W$ = "n" GOTO 1230 1220  PRINT  CHR$ (7): GOTO 1190 1230  GOSUB 5000 1240  RETURN  2000 P$ = "" 2010  FOR I = 1 TO L 2020 T% =  ASC ( MID$ (W$,I,1)) 2030  IF T% < 65 OR T% > 122 THEN P$ = "": RETURN  2040  IF T% > 90 AND T% < 97 THEN P$ = "": RETURN  2050  IF T% > 90 THEN 2070 2060 T% = T% + 32 2070 P$(I) =  CHR$ (T%) 2080 P$ = P$ + P$(I) 2090  NEXT I 2100  RETURN  5000  FOR BL = 1 TO 2: PRINT  CHR$ (7): NEXT  5010  PRINT : HTAB 24: PRINT "WORDS BEING PROCESSED   --   PLEASE WAIT": PRINT  5020  PRINT D$;"PREFIX/RAM5/DATA" 5030  IF J(0,0) = 0 THEN  GOTO 5390 5040  FOR L = 3 TO 16 5050  FOR Q = 1 TO 8 5060  IF J(L,Q) = 0 GOTO 5320 5070  PRINT D$;"OPEN L";L;".";Q 5080  PRINT D$;"READ L";L;".";Q 5100  INPUT T 5110  IF T = 1000 GOTO 5150 5120  FOR K = 1 TO (T - 1000) 5130  INPUT B$(K) 5140  NEXT K 5150  PRINT D$;"CLOSE L";L;".";Q 5160 HI = 0 5170  FOR K = 1 TO T - 1000 5180  FOR H = 1 TO J(L,Q) 5190  IF B$(K) = A$(L,Q,H) THEN A$(L,Q,H) = "":HI = HI + 1 5200  NEXT H 5210  NEXT K 5220 T = T + J(L,Q) - HI 5230  PRINT D$;"OPEN L";L;".";Q 5240  PRINT D$;"WRITE L";L;".";Q 5250  PRINT T 5260  FOR G = 1 TO J(L,Q) 5270  IF A$(L,Q,G) = "" THEN  GOTO 5300 5280  PRINT D$;"APPEND L";L;".";Q 5290  PRINT A$(L,Q,G) 5300  NEXT G 5310  PRINT D$;"CLOSE L";L;".";Q 5320  NEXT Q 5330  NEXT L 5340  FOR BL = 1 TO 4: PRINT  CHR$ (7): NEXT  5350  IF W$ = "N" OR W$ = "n" GOTO 5390 5370  GOTO 1000 5390  RETURN  15000  HOME : VTAB 12: HTAB (35) 15010  PRINT "FILE L";L;".";Q 15020  PRINT D$;"CLOSE" 15040  PRINT D$;"PREFIX/XWORD/DATA" 15050  PRINT D$;"OPEN L";L;".";Q 15060  PRINT D$;"READ L";L;".";Q 15070  INPUT TX 15080  PRINT D$;"CLOSE L";L;".";Q 15090  PRINT D$;"PREFIX/RAM5/DATA" 15100  PRINT D$;"OPEN L";L;".";Q 15110  PRINT D$;"READ L";L;".";Q 15120  INPUT T 15130  IF TX = T THEN  POP : GOTO 20175 15140  HTAB 24: PRINT "THERE ARE ";T - 1000;" WORDS IN FILE L";L;".";Q 15150  FOR W = 1 TO 15000: NEXT  15160  FOR I = 1 TO T - 1000 15170 I$ =  STR$ (I) 15180  INPUT B$(I) 15190  IF MK THEN  GOTO 15250 15200  PRINT  SPC( 4 -  LEN (I$));I;" ";B$(I); 15210 U =  PEEK (1403) 15220 U = U + 3 15230  IF U > 75 - L THEN U = 0: PRINT  15240  POKE 1403,U 15250  NEXT I 15260  PRINT D$;"CLOSE L";L;".";Q 15280  PRINT : PRINT : HTAB 30: PRINT "SORTING IN PROGRESS": PRINT : PRINT  15290 N = T - 1000 15300 M = N 15310 S = M / 2 15320 M =  INT (S) 15330  IF M = 0 THEN 15470 15340 K = N - M 15350 J = 1 15360 I = J 15370 G = I + M 15380  IF B$(I) <  = B$(G) THEN 15440 15390 T$ = B$(I) 15400 B$(I) = B$(G) 15410 B$(G) = T$ 15420 I = I - M 15430  IF I >  = 1 THEN 15370 15440 J = J + 1 15450  IF J > K THEN 15310 15460  GOTO 15360 15470  PRINT D$;"OPEN L";L;".";Q 15480  PRINT D$;"WRITE L";L;".";Q 15490  PRINT T 15500  FOR I = 1 TO T - 1000 15510  PRINT B$(I) 15520  NEXT I 15530  PRINT D$;"CLOSE L";L;".";Q 15540  RETURN  20000  VTAB 12: HTAB (20): PRINT "DO YOU WISH TO QUIT ?  (Y/N)" 20010  GET R$ 20020  IF R$ = "Y" OR R$ = "y" THEN  GOTO 20040 20030  POP : GOTO 240 20040 TT = 0 20050  FOR L = 3 TO 16 20060  FOR Q = 1 TO 8 20070  PRINT D$;"PREFIX/RAM5/DATA" 20080  GOSUB 15000 20085  PRINT : PRINT : HTAB 32: PRINT "STORING TO DISC" 20090  PRINT D$;"PREFIX/XWORD/DATA" 20100  PRINT D$;"OPEN L";L;".";Q 20110  PRINT D$;"WRITE L";L;".";Q 20120  PRINT T 20140  FOR I = 1 TO T - 1000 20150  PRINT B$(I) 20160  NEXT I 20170  PRINT D$;"CLOSE L";L;".";Q 20175 TT = TT + T - 1000 20180  NEXT Q 20190  NEXT L 20200  PRINT "Total words stored is ";TT 20210  FOR BL = 1 TO 4: PRINT  CHR$ (7): NEXT  20230  RETURN  25000  PRINT D$;"PREFIX/RAM5/DATA" 25010  HOME :J1 = 0:X = 0 25020  FOR I = 0 TO 16:W$(I) = "":WW$(I) = "":A(I) = 0: NEXT I 25030  VTAB 12: INPUT "Enter ANAGRAM letters        ";W$ 25040 L =  LEN (W$): IF L < 3 OR L > 16 THEN 25030 25050  GOSUB 2000: REM  CONVERT TO LOWER CASE LETTERS 25060  IF P$ = "" GOTO 25000 25070  FOR I = 1 TO L 25080 A(I) =  ASC ( MID$ (P$,I,1)) 25090 X = B(A(I) - 96) + X 25100 W$(I) =  CHR$ (A(I)) 25110  NEXT I 25120 A = X 25130  FOR II = 1 TO L 25140  FOR I = 2 TO L 25150  IF W$(I - 1) > W$(I) THEN W$(0) = W$(I - 1):W$(I - 1) = W$(I):W$(I) = W$(0) 25160  NEXT I 25170  NEXT II 25180  FOR I = 1 TO 8:Q$(I) = "": NEXT I 25190  FOR I = 1 TO L 25200  IF W$(I) <  CHR$ (99) AND W$(I) > Q$(1) THEN Q$(1) = W$(I): GOTO 25250 25210  IF W$(I) <  CHR$ (101) AND W$(I) >  CHR$ (98) AND W$(I) > Q$(2) THEN Q$(2) = W$(I): GOTO 25250 25220  IF W$(I) <  CHR$ (104) AND W$(I) >  CHR$ (100) AND W$(I) > Q$(3) THEN Q$(3) = W$(I): GOTO 25250 25230  IF W$(I) <  CHR$ (108) AND W$(I) >  CHR$ (103) AND W$(I) > Q$(4) THEN Q$(4) = W$(I): GOTO 25250 25232  IF W$(I) <  CHR$ (112) AND W$(I) >  CHR$ (107) AND W$(I) > Q$(5) THEN Q$(5) = W$(I): GOTO 25250 25234  IF W$(I) <  CHR$ (115) AND W$(I) >  CHR$ (111) AND W$(I) > Q$(6) THEN Q$(6) = W$(I): GOTO 25250 25236  IF W$(I) <  CHR$ (116) AND W$(I) >  CHR$ (114) AND W$(I) > Q$(7) THEN Q$(7) = W$(I): GOTO 25250 25240  IF W$(I) > Q$(8) AND W$(I) >  CHR$ (115) THEN Q$(8) = W$(I) 25250  NEXT I 25260  PRINT : PRINT "SEARCHING  --  PLEASE WAIT": PRINT  25270  FOR Q = 1 TO 8 25280  IF Q$(Q) = "" THEN  GOTO 25430 25290  PRINT D$;"OPEN L";L;".";Q 25300  PRINT D$;"READ L";L;".";Q 25310  INPUT J1 25320  IF J1 = 1000 THEN  PRINT "NO WORDS OF ";L;" CHARACTERS": GOTO 25430 25330  FOR N = 1 TO J1 - 1000 25340  INPUT C$(0) 25350  IF  MID$ (C$(0),1,1) > Q$(Q) THEN  GOTO 25430 25360 X = 0 25370  FOR I = 1 TO L 25380 A(I) =  ASC ( MID$ (C$(0),I,1)) 25390 X = B(A(I) - 96) + X 25400  NEXT I 25410  IF A = X THEN  PRINT C$(0) 25420  NEXT N 25430  PRINT D$;"CLOSE L";L;".";Q 25440  NEXT Q 25450  PRINT  25460  PRINT "Do you wish to search for other anagrams ?" 25470  PRINT "Y(es) or N(o)" 25480  GET W$ 25490  IF W$ = "Y" OR W$ = "y" THEN  HOME : GOTO 25010 25500  IF W$ = "N" OR W$ = "n" THEN  GOTO 25520 25510  GOTO 25480 25520  RETURN  30000  PRINT D$;"PREFIX/RAM5/DATA" 30010  HOME : PRINT "NUMBER of CHARACTERS = ";: GET K$ 30015  IF  ASC (K$) < 48 OR  ASC (K$) > 57 THEN  GOTO 30010 30017  PRINT K$; 30020  IF  VAL (K$) > 1 THEN  PRINT : GOTO 30040 30030  GET KK$ 30032  IF  ASC (KK$) < 48 OR  ASC (KK$) > 54 THEN  GOTO 30030 30035  PRINT KK$:K$ = K$ + KK$ 30040 L =  VAL (K$) 30050  IF L < 3 OR L > 16 GOTO 30010 30060  PRINT : PRINT "ENTER CHARACTER AGAINST POSITION NUMBER": PRINT  30070  PRINT "     USE 'SPACEBAR' FOR NULL": PRINT  30080  FOR I = 1 TO L 30090  PRINT "   ";I;" = "; 30092  GET C$(I) 30094  IF  ASC (C$(I)) = 32 THEN  GOTO 30128 30096  IF  ASC (C$(I)) < 97 THEN C$(I) =  CHR$ ( ASC (C$(I)) + 32) 30098  IF  ASC (C$(I)) > 122 THEN  GOTO 30092 30100  IF  ASC (C$(I)) < 97 THEN  GOTO 30092 30128  PRINT C$(I) 30130  NEXT I 30131  IF  ASC (C$(1)) = 32 GOTO 30140 30132  IF  ASC (C$(1)) < 99 THEN Z(0) = 1:Z(1) = 1: GOTO 30145 30133  IF  ASC (C$(1)) < 101 THEN Z(0) = 2:Z(1) = 2: GOTO 30145 30134  IF  ASC (C$(1)) < 104 THEN Z(0) = 3:Z(1) = 3: GOTO 30145 30135  IF  ASC (C$(1)) < 108 THEN Z(0) = 4:Z(1) = 4: GOTO 30145 30136  IF  ASC (C$(1)) < 112 THEN Z(0) = 5:Z(1) = 5: GOTO 30145 30137  IF  ASC (C$(1)) < 115 THEN Z(0) = 6:Z(1) = 6: GOTO 30145 30138  IF  ASC (C$(1)) < 116 THEN Z(0) = 7:Z(1) = 7: GOTO 30145 30139 Z(0) = 8:Z(1) = 8: GOTO 30145 30140 Z(0) = 1:Z(1) = 8 30145  FOR Q = Z(0) TO Z(1) 30150  PRINT D$;"OPEN L";L;".";Q 30160  PRINT D$;"READ L";L;".";Q 30170  INPUT J1 30180  IF J1 = 1000 THEN  PRINT "NO WORDS OF ";L;" CHARACTERS": GOTO 30330 30185  IF  ASC (C$(1)) > 99 THEN  GOTO 30200 30190  IF Q > 1 GOTO 30210 30200  PRINT : PRINT "SEARCHING  --  PLEASE WAIT": PRINT  30210  FOR N = 1 TO J1 - 1000 30220  INPUT B$(0) 30230  FOR I = 1 TO L 30240  IF C$(I) = " " THEN 30260 30245  IF  MID$ (B$(0),1,1) > C$(1) AND  ASC (C$(1)) > 32 THEN 30330 30250  IF C$(I) >  <  MID$ (B$(0),I,1) THEN 30320 30260  NEXT I 30270  PRINT B$(0); 30280 U =  PEEK (1403) 30290 U = U + 3 30300  IF U > 80 - L THEN U = 0: PRINT  30310  POKE 1403,U 30320  NEXT N 30330  PRINT D$;"CLOSE L";L;".";Q 30340  NEXT Q 30350  PRINT  30360  HTAB 12: PRINT "Do you wish to SEARCH for another WORD ?  Y(es) or N(o)"; 30370  GET W$ 30380  IF W$ = "Y" OR W$ = "y" THEN  HOME : GOTO 30010 30390  IF W$ = "N" OR W$ = "n" GOTO 30410 30400  GOTO 30370 30410  RETURN  30420  PRINT D$;"PREFIX/RAM5/DATA" 35000 P$ = "": HOME  35010  VTAB 10: HTAB 21: INPUT "WHAT LENGTH OF WORD FOR REMOVAL ? ";K$ 35012  IF  VAL (K$) < 3 AND  VAL (K$) > 16 THEN  GOTO 35010 35015  VTAB 15: HTAB 21: PRINT "USE 'CONTROL-S' TO HALT WORD LISTING" 35016  FOR D = 1 TO 20000: NEXT D 35040 L =  VAL (K$) 35050  IF L < 3 OR L > 16 GOTO 35000 35055  HOME : VTAB 10: HTAB 21: PRINT "WHICH SECTION CONTAINS FIRST LETTER" 35057  PRINT : HTAB (24): PRINT "a to b ...................... 1" 35058  PRINT : HTAB (24): PRINT "c to d ...................... 2" 35059  PRINT : HTAB (24): PRINT "e to g ...................... 3" 35060  PRINT : HTAB (24): PRINT "h to k ...................... 4" 35061  PRINT : HTAB (24): PRINT "l to o ...................... 5" 35062  PRINT : HTAB (24): PRINT "p to r ...................... 6" 35063  PRINT : HTAB (24): PRINT "s ........................... 7" 35064  PRINT : HTAB (24): PRINT "t to z ...................... 8" 35067  GET Q 35068  IF Q < 1 OR Q > 8 GOTO 35067 35080  PRINT D$;"OPEN L";L;".";Q 35090  PRINT D$;"READ L";L;".";Q 35100  INPUT T:TT = T 35110  IF T = 1000 THEN  GOTO 35130 35120  GOTO 35140 35130  PRINT "NO WORDS OF ";L;" CHARACTERS EXIST": GOTO 35230 35140  FOR I = 1 TO T - 1000 35150 I$ =  STR$ (I) 35160  INPUT B$(I) 35170  PRINT  SPC( 4 -  LEN (I$));I;" ";B$(I); 35180 U =  PEEK (1403) 35190 U = U + 3 35200  IF U > 75 - L THEN U = 0: PRINT  35210  POKE 1403,U 35220  NEXT I 35230  PRINT D$;"CLOSE L";L;".";Q 35240  PRINT  35250  PRINT : INPUT "WHICH NUMBER WORD IS TO BE REMOVED (0 FOR NONE) ";R 35260  IF R = 0 GOTO 35420 35265  IF R > T - 1000 GOTO 35250 35270  PRINT : INPUT "ARE YOU SURE YOU WANT TO REMOVE THAT ENTRY ? Y(es) or N(o) ";W$ 35280  IF W$ = "" GOTO 35270 35290  IF W$ = "Y" OR W$ = "y" THEN TT = TT - 1:P$ = W$: GOTO 35310 35300  GOTO 35420 35310 B$(R) = P$ 35320  PRINT D$;"DELETE L";L;".";Q 35330  PRINT D$;"OPEN L";L;".";Q 35340  PRINT D$;"WRITE L";L;".";Q 35341  FOR JJ = 1 TO 2 35342  IF JJ = 2 THEN  PRINT D$;"OPEN/XWORD/DATA/L";L;".";Q: PRINT D$;"WRITE/XWORD/DATA/L";L;".";Q 35350  PRINT TT 35360  FOR I = 1 TO T - 1000 35370  IF B$(I) = "Y" OR B$(I) = "y" GOTO 35390 35380  PRINT B$(I) 35390  NEXT I 35391  IF JJ = 2 THEN  PRINT D$;"CLOSE/XWORD/DATA/L";L;".";Q 35392  NEXT JJ 35400  PRINT D$;"CLOSE L";L;".";Q 35420  PRINT : PRINT : PRINT : PRINT "Do you wish to make other corrections ?" 35430  PRINT : PRINT "  Y(es) or N(o)" 35440  GET W$ 35450  IF W$ = "Y" OR W$ = "y" GOTO 35000 35460  IF W$ = "N" OR W$ = "n" GOTO 35480 35470  GOTO 35440 35480  RETURN  39999  REM      CLEAR REGISTERS A$(16,8,25) 40000  FOR I = 0 TO 16 40010  FOR IJ = 1 TO 8 40020 J(I,IJ) = 0 40030  FOR II = 0 TO 25 40040 A$(I,IJ,II) = "" 40050  NEXT II 40060  NEXT IJ 40070  NEXT I 40079  REM      CLEAR REGISTERS B$(3000) 40080  FOR I = 1 TO 3000 40090 B$(I) = "" 40100  NEXT I 40110  RETURN  44999  REM      LOAD RAM WITH WORDS FROM DATA FILES ON DISK 45000  FOR L = 3 TO 16 45010  FOR Q = 1 TO 8 45020  HOME : VTAB 12: PRINT "LOADING FILE L";L;".";Q;" INTO RAM" 45030  PRINT D$;"PREFIX/XWORD/DATA" 45050  PRINT D$;"OPEN L";L;".";Q 45060  PRINT D$;"READ L";L;".";Q 45070  INPUT T 45080  FOR I = 1 TO T - 1000 45090  INPUT B$(I) 45100  NEXT I 45110  PRINT D$;"CLOSE L";L;".";Q 45120  PRINT D$;"PREFIX/RAM5/DATA" 45130  PRINT D$;"OPEN L";L;".";Q 45140  PRINT D$;"WRITE L";L;".";Q 45150  PRINT T 45160  FOR I = 1 TO T - 1000 45170  PRINT B$(I) 45180  NEXT I 45190  PRINT D$;"CLOSE L";L;".";Q 45210  NEXT Q 45220  NEXT L 45230  RETURN  50000 E =  PEEK (222) 50010  PRINT "ERROR CODE ";E 50020  IF E = 19 THEN  GOTO 230 50030  IF E = 8 THEN  PRINT "I/O ERROR" 50040  IF E = 77 THEN  PRINT "OUT OF MEMORY" 50050  END 